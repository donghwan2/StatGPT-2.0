ch3_검정의 이해


@@@ ch3-1. 검정을 위한 확률 @@@

page48. 사건과 확률 
# 사건(event) : 관측치나 데이터가 특정 조건을 만족시키는 상황
[예] 로또 1등에 당첨될 사건

# 확률(probability) : 관심있는 사건이 발생할 가능성을 0부터 1사이 숫자로 표현한 값 
[예] 로또 1등에 당첨될 확률

page49. 이론적 확률과 경험적 확률
# 이론적 확률(Theoretical Probability) : 미래 예측의 의미. 수학적 원리를 기반으로 하는 확률
[예] 동전을 던질 경우 앞면이 나올 이론적 확률은 0.5


# 경험적 확률(Empirical Probability) : 과거 빈도의 의미. 관찰된 데이터와 실제 결과(통계)를 기반으로 하는 확률
[예] 동전을 100번 던져 앞면이 47번 나왔다면, 앞면이 나올 확률은 0.47

page50. 조건부 확률
# 조건부 확률(Conditional Probability) : 특정한 조건, 영역에서 계산된 확률
𝑃(𝐴│𝐵)=(𝑛(𝐴∩𝐵))/(𝑛(𝐵))=(𝑃(𝐴∩𝐵))/(𝑃(𝐵))

page51. 조건부 확률과 독립
# 독립(Independence) : 두 사건이 독립이다 -> “서로에게 영향을 미치지 않는다”
(예시) 주사위를 두 번 던져서 각각 1이 나올 사건(B)과 2가 나올  사건(A)은 서로 영향을 미치지 않는다.
-> 전체 확률과 조건부 확률이 동일
𝑃(𝐴│𝐵)=(𝑃(𝐴∩𝐵))/(𝑃(𝐵))=𝑃(𝐴)

# 독립인 경우 조건부 확률 : 두 사건이 동시에 발생활 확률은 두 확률의 곱으로 계산
𝑃(𝐴∩𝐵)=𝑃(𝐴)𝑃(𝐵)

page52. 독립과 배반
# 배반(Disjoint) : 사건 A와 사건 B는 동시에 일어날 수 없다.
(예시) 어떤 사람이 오늘 12시에 강남역을 갈 사건(A)과 오늘 12시에 홍대입구를 갈 사건(B)은 동시에 일어날 수 없다.
𝑃(𝐴∩𝐵) = 0


@@@ ch3-2. 검정의 주요 개념 @@@

page54. 기술 통계와 추론 통계
# 기술 통계(Descriptive Statistics) : 데이터의 전반적인 특성을 설명하는 과정. 
현황 파악 등 과거 자체나 현실에 초점

# 추론 통계(Inferential Statistics) : 기술 통계의 결과를 일반화, 추정, 예측하는 과정.
가설 검정, 예측 등 미래에 초점

page55. 정규분포(normal distribution) (=종모양 분포, 가우스 분포)
키, 몸무게 등 자연적인 현상들의 분포.
=> 표본을 통한 가설검정 이론의 기본

# 정규분포의 8가지 특징
1. 봉우리(정점)가 1개이다.
2. 좌우대칭이다.
3. 평균(m) 위에 봉우리(정점)가 있다.
4. 평균에서 표준편차(𝜎)만큼 떨어진 곳에 변곡점
5. x의 범위는 -∞ < x < ∞
6. 그래프와 x축으로 둘러싸인 전체 넓이는 1
7. x축에 한없이 가까워진다.
8. 봉우리(정점)의 높이는 1/(√2𝜋 𝜎)

# 모수(=파라미터)
1. 위치 모수 : 𝜇(평균)
2. 척도 모수 : 𝜎^2(분산)
=> 정규분포는 평균과 분산을 알면 어떤 그래프인지 그릴 수 있다.

page56. 왜도에 따른 평균과 중앙값 비교
# 왜도(Skewness) : 봉우리가 하나인 어떤 분포가 좌우 방향으로 쏠린 정도

# 왜도 > 0 이라면  Right Skewed, Positive Skew 라고 부르고, 평균 > 중앙값 이다.

# 왜도 < 0 이라면 Left Skewed, Negative Skew 라고 부르고, 평균 < 중앙값 이다.

page57. A 대학교 평균키는 174보다 클까?
위와 같은 질문에 답하기 위해서는 통계 검정을 활용하면 된다.


page58. 검정 중심 추론 통계의 흐름
# 우리가 궁금하게 생각하는 모집단에 대하여 전수 조사를 할 수 없기 때문에 랜덤으로 일부를 추출한 표본의 통계량을 활용하여 모집단의 특성인 모수(평균, 분산)을 추론하게 된다. 이 때 대표적 추론 방법이 추정 및 검정이 있는데 우리는 검정에 대해서 알아볼 예정이다.

page59~60. 174cm를 가정한 모집단 분포에서 표본 추출
평균이 174인 분포에서 랜덤하게 뽑은 10000개 표본의 평균들로 히스토그램을 그려보면 정규분포를 보이게 된다. 이 때 표본 평균인 약 174.45보다 큰 관측치 수를 세어보면 대략 150~200개 사이가 되고, 이것은 전체 10000개로 나누어보면 1.5~2% 사이가 된다. 통계학에서 기본적으로 5%를 기준으로 잡는데 1.5~2%는 매우 작은 확률이다. 즉, 우리가 A 대학교 평균이 174일 확률은 매우 낮다. 그러므로 결론은 “A 대학생 키 평균은 174보다 크다고 말할 수 있다.” 이다.

page61. 귀무가설 vs 대립가설
# 귀무(영)가설(null hypothesis, 𝐻_0)
(전통적 사실 or 비교 대상과) 같다, 차이가 없다 를 의미한다.
# 대립(연구)가설(alternative hypothesis, 𝐻_1, 𝐻_𝑎 )
(전통적 사실 or 비교 대상과) 차이가 있다(or 크다/작다)

page62. 가설(유의성) 검정 – 확률적 의사결정
# 검정(Test) : 귀무가설(𝐻_0)과 대립가설(𝐻_1) 둘 중에서 확률적으로 더 나은 쪽을 선택하는 과정
ex) A 대학 평균키는 174와 같다(𝐻_0) vs A 대학 평균키는 174보다 크다(𝐻_1)

# 유의 확률(significance probability), p-값(p-value) : 귀무가설이 맞다는 가정하에, 우리가 가진 데이터가 나올 확률(=우연히 차이가 났을 확률)
ex) 평균 174로 만든 분포 중 내가 가진 데이터의 평균(174.45) 이상이 나올 확률

# 유의 수준(significance level, 𝛼) : p-값 판단 기준(일반적으로 0.05 활용)
p-값 ＞0.05 -> 귀무가설(𝐻_0) 선택 (e.g. A 대학생 평균키는 174와 차이가 없다)
p-값 ≤ 0.05 -> 대립가설(𝐻_1) 선택 (e.g. A 대학생 평균키는 174보다 크다)


# 평균이 174인 분포에서 표본 평균을 10000개 추출하는 파이썬 코드
# 10,000번 표본 추출 후 평균 10,000개로 히스토그램 분포 그리기
fake_mean = []
for i in range(10000):
    fake_mean.append(np.random.normal(174, h_std, h_cnt).mean())



page63. 양측 검정과 단측 검정
# 양측 검정(Two-tailed test) : 대립 가설이 효과의 방향을 지정하지 않을 경우
- 𝐻_0 :  𝜇_𝑋=𝜇_𝑌 (두 그룹의 평균이 같다.)
- 𝐻_1 :  𝜇_𝑋≠𝜇_𝑌  (두 그룹의 평균이 다르다.)
파이썬 검정 함수 옵션으로 "two-sided"를 주면 된다.

# 단측 검정(One-tailed test)
: 대립 가설이 효과의 방향을 지정하는 경우(어느정도 검정 방향을 알고 있는 경우)
- 𝐻_0 :  𝜇_𝑋=𝜇_𝑌 (두 그룹의 평균이 같다.)
- 𝐻_1 :  𝜇_𝑋>𝜇_𝑌  (첫번째 그룹의 평균이 더 크다.)
   𝑜𝑟   𝜇_𝑋<𝜇_𝑌  (첫번째 그룹의 평균이 더 작다.)

page64. 검정 통계량으로 그룹 간 차이 검정
# 검정 통계량(Test statistics) : T값, F값, 카이제곱값
차이, 관계의 정도를 숫자로 표현한 것.
데이터가 귀무가설(𝐻_0)과 얼마나 다른지 계산한 통계량.
T, 𝐹, 𝜒^2 등 분포표를 활용하여 차이 계산.
p-value를 계산하기 위한 매개변수의 역할

# T-검정(T-test) : T값, T분포 사용
- 두 그룹(범주형) 간 수치형 변수 평균 차이 검정
- ex) 남자 수학점수와 여자 수학점수는 평균 차이가 있을까?
                         
# 분산분석(Analysis of variance, ANOVA) : F값, F분포 사용
- 세 그룹(범주형) 이상 간 수치형 변수 평균 차이 검정     
- ex) 4개 지역 별 보험료는 평균 차이가 있을까?

# 카이제곱검정(Chi-squared test) : 카이제곱값, 카이제곱분포 사용
- 두 범주형 변수의 독립성 검정(연관성 검정)
- ex) 성별과 흡연여부는 연관이 있을까?


@@@ ch3-3. 두 그룹 차이 검정(t검정) @@@

page66. 두 그룹 차이 검정 프로세스(t검정과 비모수검정)
# “남자 수학점수와 여자 수학점수는 평균 차이가 있을까?” (양측 검정)
step1. 가설 설정(귀무가설은 두 그룹의 평균이 같다)
step2. 정규성 검정
- 귀무가설 : 두 그룹은 정규분포를 따른다.
- 정규성 검정을 통과 못할 시 비모수 검정인 "윌콕슨 순위합 검정" 수행. 평균 대신 중위수 이용해서 그룹 간 차이 비교
step3. 등분산 검정
- 귀무가설 : 두 그룹의 분산은 서로 같다.
- 통과 못할 시 "Welch t-test" 수행. 파이썬 함수 옵션으로 equal_var=False
step4. (모수 검정) 독립 표본 t-test(H0 : 그룹간 평균 차이가 없다)

page67. 정규성 검정 : 데이터가 정규분포인 모집단에서 추출된 것인가
# 엄격한 방법 : 샤피로-윌크 검정(Shapiro–Wilk test), 콜모고로프-스미르노프 검정(Kolmogorov-Smirnov test)

# 유연한 방법 : 그래프를 통한 직관적 판단(histogram, QQ plot), 왜도(skewness), 첨도(kurtosis)를 이용한 정규성 검정

page68. t분포
# t분포 : 0을 중심으로 종형의 모습을 가진 대칭 분포. 자유도(df=n-1)가 커질수록 표준정규분포에 근사해감


@@@ ch3-4. 세 그룹 이상 차이 검정(분산분석=ANOVA) @@@

page70. 일반적인 그룹(세 그룹 이상) 평균 비교 - 분산 분석
ex) 네 지역의 보험료는 차이가 있을까?

# 분산 분석(analysis of variance ; ANOVA) : 분산을 이용해서, 여러 그룹별 평균의 차이에 대한 검정. F 통계량과 F분포를 사용한다.

# 파이썬의 분산분석 함수
1. stats.f_oneway()
2. anova_lm()

# 분산분석의 귀무가설과 대립가설
- 𝐻_0 : 𝜏_1=𝜏_2=⋯=𝜏_𝑘 ; 그룹 간 평균 차이가 없음
- 𝐻_1 : 𝑛𝑜𝑡 𝐻_0 ; 적어도 두 그룹은 평균 차이가 있음

page71. 일반적인 그룹(세 그룹 이상) 차이 검정 프로세스
ex) 네 지역의 보험료는 차이가 있을까?
step1. 가설 설정(귀무가설은 두 그룹의 평균이 같다)
step2. 정규성 검정
- 귀무가설 : 두 그룹은 정규분포를 따른다.
- 정규성 검정을 통과 못할 시 비모수 검정인 "Kruskal-Wallis 검정" 수행. 평균 대신 중위수 이용해서 그룹 간 차이 비교
step3. 등분산 검정
- 귀무가설 : 두 그룹의 분산은 서로 같다.
- 통과 못할 시 "Welch ANOVA" 수행. 파이썬 함수 옵션으로 equal_var=False
step4. (모수 검정) ANOVA (H0 : 그룹간 평균 차이가 없다)


@@@ ch3-5. 독립성검정(카이제곱검정) @@@

page73. 범주형 변수의 교차표와 독립성 검정
# 독립성 검정(test of independence) : 두 범주형 변수가 서로 독립인지 아닌지를 판단하는 과정.
두 범주형 변수의 교차표와 독립을 가정한 교차표를 비교

# 독립성 검정의 가설
- 𝐻_0: 두 범주형 변수가 독립
- 𝐻_1: 두 범주형 변수가 독립이 아님

# 독립성 검정 예제
[예] 연령대별 상품 주문량 교차표 -> 20대는 상품 A, 30대는 상품 C를 선호하는가?


page74. 독립성 검정과 카이제곱값 계산
# 카이제곱(Chi-Square) 값 : 독립성 검정을 위한 카이제곱값의 계산.
교차표의 각 칸이 귀무가설 기준 예상값보다 전반적으로 얼마나 큰 지를 계산한다.
구한 카이제곱값은 카이제곱분포에 대입해서 최종적으로 p-value를 구한다.

page76. 검정과 오류
# 검정 오류(error) 발생 : 데이터 1개와 가정으로 판단하는 검정의 과정에서 확률을 활용하기 때문에 오류가 발생할 수 밖에 없음

# 1종 오류(Type 1 error) : 귀무가설이 사실인데도 기각한 오류.
데이터에 차이/관계가 있는 것처럼 보였지만, 실제로는 차이/관계가 없는 경우.

# 2종 오류(Type 2 error) : 귀무가설이 거짓인데 기각을 못한 오류.
데이터에 차이/관계가 없었지만 실제로는 차이/관계가 있는 경우.

--- End of Chapter3 ---









